#pragma once
#include <SFML/Graphics.hpp>

/**
 * @class Timer
 * @brief Класс для управления временем игрока в шахматной игре.
 *
 * Класс предоставляет функционал для управления таймером, включая
 * старт, паузу, сброс, обновление состояния и отрисовку оставшегося времени.
 */
class Timer {
 public:
  /**
   * @brief Конструктор таймера.
   *
   * @param total_time Общее время для игрока (в секундах).
   * @param font Шрифт для отображения текста таймера.
   * @param position Позиция для отображения таймера на экране.
   */
  Timer(float total_time, const sf::Font& font, const sf::Vector2f& position);

  /**
   * @brief Запускает таймер.
   */
  void Start();

  /**
   * @brief Останавливает таймер.
   */
  void Stop();

  /**
   * @brief Сбрасывает таймер на изначальное общее время.
   */
  void Reset();

  /**
   * @brief Обновляет состояние таймера.
   *
   * Этот метод нужно вызывать в игровом цикле для корректного уменьшения
   * оставшегося времени.
   */
  void Update();

  /**
   * @brief Проверяет, истекло ли время.
   *
   * @return true, если время закончилось, иначе false.
   */
  bool IsTimeUp() const;

  /**
   * @brief Отображает таймер на указанном окне.
   *
   * @param window Окно SFML, на котором нужно отрисовать таймер.
   */
  void Draw(sf::RenderWindow& window);

  /**
   * @brief Возвращает оставшееся время.
   *
   * @return Оставшееся время в секундах.
   */
  float GetRemainingTime() const;

  /**
   * @brief Устанавливает оставшееся время.
   *
   * @param time Новое значение оставшегося времени (в секундах).
   */
  void SetRemainingTime(float time);

 private:
  float total_time_; /**< Общее время для игрока (в секундах). */
  float elapsed_time_; /**< Время, которое прошло с начала игры. */
  bool is_running_; /**< Флаг, указывающий, запущен ли таймер. */
  sf::Clock clock_; /**< Встроенный таймер SFML для отслеживания времени. */
  sf::Text text_; /**< Текст SFML для отображения оставшегося времени. */
  float paused_time_; /**< Время, зафиксированное при остановке таймера. */

  /**
   * @brief Обновляет отображение текста таймера.
   *
   * Вызывается внутри Update() для синхронизации текста с текущим состоянием
   * времени.
   */
  void UpdateDisplay();
};
